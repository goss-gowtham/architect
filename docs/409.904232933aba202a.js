"use strict";(self.webpackChunkarchitect=self.webpackChunkarchitect||[]).push([[409],{1409:(rt,C,i)=>{i.r(C),i.d(C,{ClientsModule:()=>st});var h=i(177),g=i(6530),z=i(4181),t=i(4438),b=i(4796),A=i(7772),S=i(9885),k=i(6368),E=i(6648),I=i(5558),M=i(6354),v=i(1626);let w=(()=>{class o{http;testMode=!0;key="KfPgjF";salt="MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDITVAeH89oo1hL+8eMcnrZjjKPiW7StfX3WA6gwh/VORR2Cat6EB6YEwFj+rQCJAcXRcjoE2rtruBEfWJlKpZ0ohiYqUOQjrTONgjwbqYwJU3LaCD2dY7PDMCPoylKIv5GO1WLdLQJBc7CQkcNag7gnEDGVLseO65dx2WdnsJQOJij+RdrmiTjrL+OXTCKihWgU06k/Q7Y4JfdPXSjiwYcOnHTpSYrYbBdVWyz+RBJM84ZzIDRHkQFEhSL9Nu98uyINrpyB3wQegDZltCbxD0sb8JP3KSCkBnBiXO56wvWUcg36XkxqWHBVBP0ZgymIHMGaLzWX6FYcUh4HGmRQiRbAgMBAAECggEAFtC/pH7JGEkq4JTQWQ4dMjTBS5pC9ltlpgPwvpz+FUKIMx3M232Ejpvzl5jR8kB6UktPpCe6EVLPFt4VXCKquqRQGuuE1615qNd80y43XdqR7u5wesJPPwRb1sCmDlzIC+XsS5NCgpiXwYbdIwkGos0Jj83M9pejt+jjiT2xMoPcFCL1hUsuNBORvyOZBGaajPC9goO1NJCmrtnik6Gzx+UOR6ZiOjj50so7kYbg0QUHa28nLf8B/JhL4DL9nKHNBV2qEYl3v3YLoA2FP9qne8fOL1Ml75zK+sR8eiinBmOl0OQcNkBOsFsUEiMDNO+74PlpbwPotedojH7ErYkH0QKBgQD12uCmw8C4MzOwT5SjlkXyIWGai9AuWXTmWW9KwHjftTmwRp+X7gS8bWtLdIYd4L3rUIoCNvKmRNxaQMuN80fFgJ/Ofy6nfJq7ShPm//RFknLY/WvNi9gb4pDxqn5GnMfMbMD+JMBz6y75ADBPSJVmeqUv9oAbP+NObja27dXo4wKBgQDQkTrzcSCZvfU97bO6qtKhGAUQVrl0f6Gg3YgWbMiTmzP7/zIkJkbVAzhFrPd6n/PUkqUisN28j1UFe2Hk+EO8TY8NuH7efag6V+Ht2SHZIlQWGs42K5u/eN0H2dHlL0vn0P2TfTy1tbYeCHCtoGIKXHadxDiPDYrXKmWA1YBIKQKBgQCRYabqtmLmCdEM92IsAhbGgZrX6slmPxvzgvtetsZDc0Tzyi9hhixiyElkSzlrvZRQ7EVP3fJLA/lRnXNBM5VDYzYcw/RwsixFiB6QwNZPtbQYQHNZDtLyWl3fqjQVyWwUpFLTdiQf5/jU4ZmvqHpAKVI5NIi4lGTz4hSUw7t0hQKBgA7x2R+Ig6WAjwoY9j/x7ZXNes9o53EJlDNKrG2u7dBl1pu/9X/RnlG1IVscwb7vpzEcMOkDc2AHhTgXVzRo9bGQfSemiLC4oE1N7sp0PJCqfQv4b75B8a8Oogfl+7xIX1AFEaZ32tnKY3pTcH+AdoX3iihT3xmhBsnUJ+HLap3BAoGBAO1E7ky8VwbI4fhjaiAceocDdUhYsalhZZqZfQQ8+jjwfxRH8z1amiQxpSXNOV25rHur/3lKcYj1IBVeCiJlemQr6+ZW41e2QelOJ4OdCQ77SdQq1TgklVPSPDZTitL+MkredR2ki/MYSlDY7PyUmgU5AfkMpUgnfBC/+jeggJGo";constructor(e){this.http=e}initiatePayUPayment(e){const n=this.testMode?"https://test.payu.in/_payment":"https://secure.payu.in/_payment",s=(0,k.A)(),r=`${window.location.origin}/architect/clients?status=success&projectId=${e.projectId}&userId=${e.username}`,a=`${window.location.origin}/architect/clients?status=failure`;return this.generateHash(`${this.key}|${s}|${e.pay}|${e.project}|${e.username}|user@example.com|||||||||||${this.salt}`).pipe((0,I.n)(f=>{const P={key:this.key,txnid:s,amount:e.pay,productinfo:e.project,firstname:e.username,email:"user@example.com",phone:"1234567890",surl:r,furl:a,hash:f,service_provider:""},it=new v.Lr({"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, OPTIONS, POST","Access-Control-Allow-Headers":"*"}),x=new URLSearchParams;return Object.keys(P).forEach(T=>{x.set(T,P[T])}),this.http.post(n,x.toString(),{headers:it})}))}generateHash(e){const n=(new TextEncoder).encode(e);return(0,E.H)(crypto.subtle.digest("SHA-512",n)).pipe((0,M.T)(s=>this.bufferToHex(s)))}bufferToHex(e){return Array.prototype.map.call(new Uint8Array(e),n=>("00"+n.toString(16)).slice(-2)).join("")}static \u0275fac=function(n){return new(n||o)(t.KVO(v.Qq))};static \u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var B=i(1279),O=i(9803),m=i(2914),d=i(5664),y=i(513),U=i(6389),D=i(5930),G=i(1413),R=i(6977),p=i(6006),X=i(8203);const N=["*"];function Y(o,c){if(1&o){const e=t.RV6();t.j41(0,"nz-icon",1),t.bIt("click",function(s){t.eBV(e);const r=t.XpG();return t.Njj(r.closeTag(s))}),t.k0s()}}let j=(()=>{class o{constructor(e,n,s,r){this.cdr=e,this.renderer=n,this.elementRef=s,this.directionality=r,this.isPresetColor=!1,this.nzMode="default",this.nzChecked=!1,this.nzBordered=!0,this.nzOnClose=new t.bkB,this.nzCheckedChange=new t.bkB,this.dir="ltr",this.destroy$=new G.B}updateCheckedStatus(){"checkable"===this.nzMode&&(this.nzChecked=!this.nzChecked,this.nzCheckedChange.emit(this.nzChecked))}closeTag(e){this.nzOnClose.emit(e),e.defaultPrevented||this.renderer.removeChild(this.renderer.parentNode(this.elementRef.nativeElement),this.elementRef.nativeElement)}clearPresetColor(){const e=this.elementRef.nativeElement,n=new RegExp(`(ant-tag-(?:${[...p.un,...p.PA].join("|")}))`,"g"),s=e.classList.toString(),r=[];let a=n.exec(s);for(;null!==a;)r.push(a[1]),a=n.exec(s);e.classList.remove(...r)}setPresetColor(){const e=this.elementRef.nativeElement;this.clearPresetColor(),this.isPresetColor=!!this.nzColor&&((0,p.nP)(this.nzColor)||(0,p.uP)(this.nzColor)),this.isPresetColor&&e.classList.add(`ant-tag-${this.nzColor}`)}ngOnInit(){this.directionality.change?.pipe((0,R.Q)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(e){const{nzColor:n}=e;n&&this.setPresetColor()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(n){return new(n||o)(t.rXU(t.gRc),t.rXU(t.sFG),t.rXU(t.aKT),t.rXU(X.dS))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["nz-tag"]],hostAttrs:[1,"ant-tag"],hostVars:12,hostBindings:function(n,s){1&n&&t.bIt("click",function(){return s.updateCheckedStatus()}),2&n&&(t.xc7("background-color",s.isPresetColor?"":s.nzColor),t.AVh("ant-tag-has-color",s.nzColor&&!s.isPresetColor)("ant-tag-checkable","checkable"===s.nzMode)("ant-tag-checkable-checked",s.nzChecked)("ant-tag-rtl","rtl"===s.dir)("ant-tag-borderless",!s.nzBordered))},inputs:{nzMode:"nzMode",nzColor:"nzColor",nzChecked:[2,"nzChecked","nzChecked",t.L39],nzBordered:[2,"nzBordered","nzBordered",t.L39]},outputs:{nzOnClose:"nzOnClose",nzCheckedChange:"nzCheckedChange"},exportAs:["nzTag"],features:[t.GFd,t.OA$],ngContentSelectors:N,decls:2,vars:1,consts:[["nzType","close","tabindex","-1",1,"ant-tag-close-icon"],["nzType","close","tabindex","-1",1,"ant-tag-close-icon",3,"click"]],template:function(n,s){1&n&&(t.NAR(),t.SdG(0),t.DNE(1,Y,1,0,"nz-icon",0)),2&n&&(t.R7$(),t.vxM("closeable"===s.nzMode?1:-1))},dependencies:[d.Y3,d.Dn],encapsulation:2,changeDetection:0})}}return o})(),Q=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[j]})}}return o})();var u=i(7529);const F=()=>[48,24],L=o=>[o];function H(o,c){1&o&&(t.j41(0,"div",6)(1,"p"),t.EFF(2,"No projects available. Request for a project to pay and download."),t.k0s()())}function $(o,c){if(1&o&&t.nrm(0,"img",14),2&o){const e=t.XpG(2).$implicit;t.Y8G("alt",e.project)("src",null==e?null:e.thumbnail,t.B4B)}}function V(o,c){1&o&&t.nrm(0,"div",15)}function J(o,c){if(1&o&&(t.j41(0,"nz-tag",16),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2).$implicit;t.R7$(),t.JRh(e.username)}}function K(o,c){if(1&o&&(t.j41(0,"div",10),t.DNE(1,$,1,2,"img",11)(2,V,1,0,"ng-template",null,2,t.C5r),t.j41(4,"nz-tag",12),t.EFF(5),t.k0s(),t.DNE(6,J,2,1,"nz-tag",13),t.k0s()),2&o){const e=t.sdS(3),n=t.XpG().$implicit,s=t.XpG();t.R7$(),t.Y8G("ngIf",null==n?null:n.thumbnail)("ngIfElse",e),t.R7$(4),t.SpI("INR ",n.pay,""),t.R7$(),t.Y8G("ngIf",s.isAdminOrMaster)}}function _(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){t.eBV(e);const s=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.handlePayAndDownload(s))}),t.nrm(1,"nz-icon",19),t.EFF(2,"Download "),t.k0s()}}function W(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){t.eBV(e);const s=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.handlePayAndDownload(s))}),t.nrm(1,"nz-icon",20),t.EFF(2,"Pay & Download "),t.k0s()}}function Z(o,c){if(1&o&&t.DNE(0,_,3,0,"button",17)(1,W,3,0,"button",17),2&o){const e=t.XpG().$implicit,n=t.XpG();t.Y8G("ngIf",e.paid||n.isAdminOrMaster),t.R7$(),t.Y8G("ngIf",!e.paid&&!n.isAdminOrMaster)}}function q(o,c){if(1&o&&(t.j41(0,"div",7)(1,"nz-card",8),t.nrm(2,"nz-card-meta",9),t.k0s(),t.DNE(3,K,7,4,"ng-template",null,0,t.C5r)(5,Z,2,2,"ng-template",null,1,t.C5r),t.k0s()),2&o){const e=c.$implicit,n=t.sdS(4),s=t.sdS(6);t.R7$(),t.Y8G("nzCover",n)("nzActions",t.eq3(4,L,s)),t.R7$(),t.Y8G("nzTitle",e.project)("nzDescription",e.desc)}}const tt=[{path:"",component:(()=>{class o{authService;dbService;userService;paymentService;route;projectService;notification;cards=[];clientLogo="";isAdminOrMaster=!1;constructor(e,n,s,r,a,l,f){this.authService=e,this.dbService=n,this.userService=s,this.paymentService=r,this.route=a,this.projectService=l,this.notification=f}ngOnInit(){const e=this.authService.currentUserValue;e&&(this.isAdminOrMaster=e.roles.includes(z.Y.admin)||e.roles.includes(z.Y.master),this.dbService.getClientLogo(e.client).subscribe(n=>{this.clientLogo=n,this.isAdminOrMaster?this.loadAllUserProjects(e.client):this.loadCurrentUserProjects(e.id)},n=>{console.error("Error fetching client logo:",n)})),this.route.queryParams.subscribe(n=>{const s=n.status,r=n.projectId,a=n.userId;"success"===s&&r&&a?this.projectService.updateProjectPaymentStatus(a,r,!0).subscribe(()=>{this.notification.success("Success","Payment successful. You can now download the file."),this.downloadFile(this.cards.find(l=>l.projectId===r)?.file||"")},l=>{console.error("Error updating payment status:",l)}):"failure"===s&&this.notification.error("Error","Payment failed. Please try again.")})}loadAllUserProjects(e){this.userService.getUsers(e).subscribe(n=>{n&&(this.cards=n.flatMap(s=>s.projects.map(r=>({...r,thumbnail:this.clientLogo,username:s.username}))))},n=>{console.error("Error fetching user projects:",n)})}loadCurrentUserProjects(e){this.userService.getUser(e).subscribe(n=>{n&&(this.cards=n.projects.map(s=>({...s,thumbnail:this.clientLogo,username:n.username})))},n=>{console.error("Error fetching user projects:",n)})}downloadFile(e){const n=document.createElement("a");n.href=e,n.download=e.split("/").pop()||"download",n.click()}handlePayAndDownload(e){e.paid||this.isAdminOrMaster?(this.downloadFile(e.file),this.notification.success("Success","Downloaded successfully")):this.paymentService.initiatePayUPayment(e).subscribe({next:()=>{console.log("Payment initiation complete")},error:n=>{console.error("Error initiating payment:",n),this.notification.error("Error","Error initiating payment. Please try again.")}})}static \u0275fac=function(n){return new(n||o)(t.rXU(b.u),t.rXU(A.a),t.rXU(S.D),t.rXU(w),t.rXU(g.nX),t.rXU(B.T),t.rXU(O.xY))};static \u0275cmp=t.VBU({type:o,selectors:[["app-clients"]],standalone:!1,decls:3,vars:4,consts:[["coverTemplate",""],["payDownload",""],["placeholder",""],["nz-row","",3,"nzGutter"],["class","no-projects-message",4,"ngIf"],["nz-col","24","nzXs","24","nzSm","24","nzMd","12","nzLg","6","nzXl","6",4,"ngFor","ngForOf"],[1,"no-projects-message"],["nz-col","24","nzXs","24","nzSm","24","nzMd","12","nzLg","6","nzXl","6"],[1,"card-shadow",2,"width","280px","height","320px",3,"nzCover","nzActions"],[3,"nzTitle","nzDescription"],[2,"position","relative"],["width","280px","style","min-height:150px; max-height: 200px;",3,"alt","src",4,"ngIf","ngIfElse"],["nzColor","success",2,"position","absolute","top","5px","right","0px"],["nzColor","processing","style","position: absolute; bottom: 5px; right: 0px;",4,"ngIf"],["width","280px",2,"min-height","150px","max-height","200px",3,"alt","src"],[2,"width","280px","height","170px","background-color","#f0f0f0"],["nzColor","processing",2,"position","absolute","bottom","5px","right","0px"],["nz-button","","nzType","default","nzShape","round",3,"click",4,"ngIf"],["nz-button","","nzType","default","nzShape","round",3,"click"],["nzType","download"],["nzType","credit-card"]],template:function(n,s){1&n&&(t.j41(0,"div",3),t.DNE(1,H,3,0,"div",4)(2,q,7,6,"div",5),t.k0s()),2&n&&(t.Y8G("nzGutter",t.lJ4(3,F)),t.R7$(),t.Y8G("ngIf",0===s.cards.length),t.R7$(),t.Y8G("ngForOf",s.cards))},dependencies:[h.Sq,h.bT,m.cK,m.ls,d.Dn,y.aO,U.c,D.p,j,u.Uq,u.e],styles:[".no-projects-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%;text-align:center;padding:20px}.card-shadow[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0000001a,0 6px 10px #0000001a}.no-projects-message[_ngcontent-%COMP%]{text-align:center;font-size:18px;color:#888;margin-top:50px}"]})}return o})()}];let et=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=t.G2t({imports:[g.iI.forChild(tt),g.iI]})}return o})();var nt=i(9692),ot=i(1672);let st=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=t.G2t({imports:[h.MD,et,m.Ti,d.Y3,y.Zw,Q,u.f3,nt.y,ot._v]})}return o})()}}]);