"use strict";(self.webpackChunkarchitect=self.webpackChunkarchitect||[]).push([[409],{1409:(ot,v,s)=>{s.r(v),s.d(v,{ClientsModule:()=>nt});var m=s(177),g=s(6530),y=s(4181),t=s(4438),_=s(4796),$=s(7772),P=s(9885),k=s(6368),E=s(6648),T=s(6354);let I=(()=>{class o{testMode=!0;key="your_payu_key";salt="your_payu_salt";initiatePayUPayment(e){const n=this.testMode?"https://test.payu.in/_payment":"https://secure.payu.in/_payment",i=(0,k.A)(),r=`${window.location.origin}/clients?status=success&projectId=${e.projectId}&userId=${e.username}`,c=`${window.location.origin}/clients?status=failure`;return this.generateHash(`${this.key}|${i}|${e.pay}|${e.project}|${e.username}|||||||||||${this.salt}`).pipe((0,T.T)(C=>{const d=document.createElement("form");d.method="POST",d.action=n;const j={key:this.key,txnid:i,amount:e.pay,productinfo:e.project,firstname:e.username,email:"user@example.com",phone:"1234567890",surl:r,furl:c,hash:C,service_provider:"payu_paisa"};Object.keys(j).forEach(S=>{const u=document.createElement("input");u.type="hidden",u.name=S,u.value=j[S],d.appendChild(u)}),document.body.appendChild(d),d.submit()}))}generateHash(e){const n=(new TextEncoder).encode(e);return(0,E.H)(crypto.subtle.digest("SHA-512",n)).pipe((0,T.T)(i=>this.bufferToHex(i)))}bufferToHex(e){return Array.prototype.map.call(new Uint8Array(e),n=>("00"+n.toString(16)).slice(-2)).join("")}static \u0275fac=function(n){return new(n||o)};static \u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var M=s(1279),G=s(9803),f=s(2914),p=s(5664),x=s(513),D=s(6389),X=s(5930),R=s(1413),U=s(6977),h=s(6006),F=s(8203);const O=["*"];function w(o,a){if(1&o){const e=t.RV6();t.j41(0,"nz-icon",1),t.bIt("click",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.closeTag(i))}),t.k0s()}}let b=(()=>{class o{constructor(e,n,i,r){this.cdr=e,this.renderer=n,this.elementRef=i,this.directionality=r,this.isPresetColor=!1,this.nzMode="default",this.nzChecked=!1,this.nzBordered=!0,this.nzOnClose=new t.bkB,this.nzCheckedChange=new t.bkB,this.dir="ltr",this.destroy$=new R.B}updateCheckedStatus(){"checkable"===this.nzMode&&(this.nzChecked=!this.nzChecked,this.nzCheckedChange.emit(this.nzChecked))}closeTag(e){this.nzOnClose.emit(e),e.defaultPrevented||this.renderer.removeChild(this.renderer.parentNode(this.elementRef.nativeElement),this.elementRef.nativeElement)}clearPresetColor(){const e=this.elementRef.nativeElement,n=new RegExp(`(ant-tag-(?:${[...h.un,...h.PA].join("|")}))`,"g"),i=e.classList.toString(),r=[];let c=n.exec(i);for(;null!==c;)r.push(c[1]),c=n.exec(i);e.classList.remove(...r)}setPresetColor(){const e=this.elementRef.nativeElement;this.clearPresetColor(),this.isPresetColor=!!this.nzColor&&((0,h.nP)(this.nzColor)||(0,h.uP)(this.nzColor)),this.isPresetColor&&e.classList.add(`ant-tag-${this.nzColor}`)}ngOnInit(){this.directionality.change?.pipe((0,U.Q)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(e){const{nzColor:n}=e;n&&this.setPresetColor()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(n){return new(n||o)(t.rXU(t.gRc),t.rXU(t.sFG),t.rXU(t.aKT),t.rXU(F.dS))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["nz-tag"]],hostAttrs:[1,"ant-tag"],hostVars:12,hostBindings:function(n,i){1&n&&t.bIt("click",function(){return i.updateCheckedStatus()}),2&n&&(t.xc7("background-color",i.isPresetColor?"":i.nzColor),t.AVh("ant-tag-has-color",i.nzColor&&!i.isPresetColor)("ant-tag-checkable","checkable"===i.nzMode)("ant-tag-checkable-checked",i.nzChecked)("ant-tag-rtl","rtl"===i.dir)("ant-tag-borderless",!i.nzBordered))},inputs:{nzMode:"nzMode",nzColor:"nzColor",nzChecked:[2,"nzChecked","nzChecked",t.L39],nzBordered:[2,"nzBordered","nzBordered",t.L39]},outputs:{nzOnClose:"nzOnClose",nzCheckedChange:"nzCheckedChange"},exportAs:["nzTag"],features:[t.GFd,t.OA$],ngContentSelectors:O,decls:2,vars:1,consts:[["nzType","close","tabindex","-1",1,"ant-tag-close-icon"],["nzType","close","tabindex","-1",1,"ant-tag-close-icon",3,"click"]],template:function(n,i){1&n&&(t.NAR(),t.SdG(0),t.DNE(1,w,1,0,"nz-icon",0)),2&n&&(t.R7$(),t.vxM("closeable"===i.nzMode?1:-1))},dependencies:[p.Y3,p.Dn],encapsulation:2,changeDetection:0})}}return o})(),A=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[b]})}}return o})();var z=s(7529);const N=()=>[48,24],B=o=>[o];function Y(o,a){if(1&o&&t.nrm(0,"img",12),2&o){const e=t.XpG(2).$implicit;t.Y8G("alt",e.project)("src",null==e?null:e.thumbnail,t.B4B)}}function L(o,a){1&o&&t.nrm(0,"div",13)}function V(o,a){if(1&o&&(t.j41(0,"nz-tag",14),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2).$implicit;t.R7$(),t.JRh(e.username)}}function H(o,a){if(1&o&&(t.j41(0,"div",8),t.DNE(1,Y,1,2,"img",9)(2,L,1,0,"ng-template",null,2,t.C5r),t.j41(4,"nz-tag",10),t.EFF(5),t.k0s(),t.DNE(6,V,2,1,"nz-tag",11),t.k0s()),2&o){const e=t.sdS(3),n=t.XpG().$implicit,i=t.XpG();t.R7$(),t.Y8G("ngIf",null==n?null:n.thumbnail)("ngIfElse",e),t.R7$(4),t.SpI("INR ",n.pay,""),t.R7$(),t.Y8G("ngIf",i.isAdminOrMaster)}}function J(o,a){if(1&o){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.handlePayAndDownload(i))}),t.nrm(1,"nz-icon",17),t.EFF(2,"Download "),t.k0s()}}function K(o,a){if(1&o){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.handlePayAndDownload(i))}),t.nrm(1,"nz-icon",18),t.EFF(2,"Pay & Download "),t.k0s()}}function Q(o,a){if(1&o&&t.DNE(0,J,3,0,"button",15)(1,K,3,0,"button",15),2&o){const e=t.XpG().$implicit,n=t.XpG();t.Y8G("ngIf",e.paid||n.isAdminOrMaster),t.R7$(),t.Y8G("ngIf",!e.paid&&!n.isAdminOrMaster)}}function Z(o,a){if(1&o&&(t.j41(0,"div",5)(1,"nz-card",6),t.nrm(2,"nz-card-meta",7),t.k0s(),t.DNE(3,H,7,4,"ng-template",null,0,t.C5r)(5,Q,2,2,"ng-template",null,1,t.C5r),t.k0s()),2&o){const e=a.$implicit,n=t.sdS(4),i=t.sdS(6);t.R7$(),t.Y8G("nzCover",n)("nzActions",t.eq3(4,B,i)),t.R7$(),t.Y8G("nzTitle",e.project)("nzDescription",e.desc)}}const W=[{path:"",component:(()=>{class o{authService;dbService;userService;paymentService;route;projectService;notification;cards=[];clientLogo="";isAdminOrMaster=!1;constructor(e,n,i,r,c,l,C){this.authService=e,this.dbService=n,this.userService=i,this.paymentService=r,this.route=c,this.projectService=l,this.notification=C}ngOnInit(){const e=this.authService.currentUserValue;e&&(this.isAdminOrMaster=e.roles.includes(y.Y.admin)||e.roles.includes(y.Y.master),this.dbService.getClientLogo(e.client).subscribe(n=>{this.clientLogo=n,this.userService.getUsers(e.client).subscribe(i=>{i&&(this.cards=i.flatMap(r=>r.projects.map(c=>({...c,thumbnail:this.clientLogo,username:r.username}))))},i=>{console.error("Error fetching user projects:",i)})},n=>{console.error("Error fetching client logo:",n)})),this.route.queryParams.subscribe(n=>{const i=n.status,r=n.projectId,c=n.userId;"success"===i&&r&&c?this.projectService.updateProjectPaymentStatus(c,r,!0).subscribe(()=>{this.notification.success("Success","Payment successful. You can now download the file."),this.downloadFile(this.cards.find(l=>l.projectId===r)?.file||"")},l=>{console.error("Error updating payment status:",l)}):"failure"===i&&this.notification.error("Error","Payment failed. Please try again.")})}downloadFile(e){const n=document.createElement("a");n.href=e,n.download=e.split("/").pop()||"download",n.click()}handlePayAndDownload(e){e.paid||this.isAdminOrMaster?(this.downloadFile(e.file),this.notification.success("Success","Downloaded successfully")):this.paymentService.initiatePayUPayment(e).subscribe({error:n=>{console.error("Error initiating payment:",n),this.notification.error("Error","Error initiating payment. Please try again.")},complete:()=>{console.log("Payment initiation complete")}})}static \u0275fac=function(n){return new(n||o)(t.rXU(_.u),t.rXU($.a),t.rXU(P.D),t.rXU(I),t.rXU(g.nX),t.rXU(M.T),t.rXU(G.xY))};static \u0275cmp=t.VBU({type:o,selectors:[["app-clients"]],standalone:!1,decls:2,vars:3,consts:[["coverTemplate",""],["payDownload",""],["placeholder",""],["nz-row","",3,"nzGutter"],["nz-col","24","nzXs","24","nzSm","24","nzMd","12","nzLg","6","nzXl","6",4,"ngFor","ngForOf"],["nz-col","24","nzXs","24","nzSm","24","nzMd","12","nzLg","6","nzXl","6"],[1,"card-shadow",2,"width","280px","height","320px",3,"nzCover","nzActions"],[3,"nzTitle","nzDescription"],[2,"position","relative"],["width","280px","style","min-height:150px",3,"alt","src",4,"ngIf","ngIfElse"],["nzColor","success",2,"position","absolute","top","5px","right","0px"],["nzColor","processing","style","position: absolute; bottom: 5px; right: 0px;",4,"ngIf"],["width","280px",2,"min-height","150px",3,"alt","src"],[2,"width","280px","height","170px","background-color","#f0f0f0"],["nzColor","processing",2,"position","absolute","bottom","5px","right","0px"],["nz-button","","nzType","default","nzShape","round",3,"click",4,"ngIf"],["nz-button","","nzType","default","nzShape","round",3,"click"],["nzType","download"],["nzType","credit-card"]],template:function(n,i){1&n&&(t.j41(0,"div",3),t.DNE(1,Z,7,6,"div",4),t.k0s()),2&n&&(t.Y8G("nzGutter",t.lJ4(2,N)),t.R7$(),t.Y8G("ngForOf",i.cards))},dependencies:[m.Sq,m.bT,f.cK,f.ls,p.Dn,x.aO,D.c,X.p,b,z.Uq,z.e],styles:[".no-projects-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%;text-align:center;padding:20px}.card-shadow[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0000001a,0 6px 10px #0000001a}"]})}return o})()}];let q=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=t.G2t({imports:[g.iI.forChild(W),g.iI]})}return o})();var tt=s(9692),et=s(1672);let nt=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=t.G2t({imports:[m.MD,q,f.Ti,p.Y3,x.Zw,A,z.f3,tt.y,et._v]})}return o})()}}]);